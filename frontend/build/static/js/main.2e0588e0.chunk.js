(this["webpackJsonpreact-chat"]=this["webpackJsonpreact-chat"]||[]).push([[0],{56:function(e,t,n){e.exports=n(98)},94:function(e,t){},98:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n.n(s),r=n(20),c=n(10),o=n(12),i=n(51),u=n(52),m=n(55),l=n(32),d={username:"Guest".concat(Math.floor(1001*Math.random())),messages:[]};var g=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SEND_MESSAGE_REQUEST":return Object(l.a)({},e,{messages:e.messages.concat(t.message)});case"SEND_MESSAGE_RESPONSE":return Object(l.a)({},e,{messages:[].concat(Object(m.a)(e.messages),[t.message])});default:return e}},p={connected:!1};var h=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case"CONNECTION_CHANGED":e=Object.assign({},t,{connected:n.connected,isError:!1});break;default:e=t}return e},f={usernames:[]};var E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_JOINED":return{usernames:e.usernames.concat(t.username)};case"USER_LEFT":return{usernames:e.usernames.filter((function(e){return e!==t.username}))};case"CHANGE_USERNAME":return{usernames:e.usernames.map((function(e){return e===t.username?t.username:e}))};default:return e}},v=n(3),O=n(21),b=n.n(O),S="connect",k="disconnect",y="message",C="chatbot",T="update_user_list",N=function e(t,n){var s=this;Object(v.a)(this,e),this.username=void 0,this.port=void 0,this.onChange=void 0,this.onMessage=void 0,this.socket=void 0,this.connect=function(e,t){s.username=e,s.port=t,s.socket=O.connect(),s.socket.on(S,s.onConnected)},this.onConnected=function(){s.socket.on(y,s.onMessage),s.onChange(!0);var e={username:"Chat Bot",message:"Hello "+s.username+"! Change the nickname and start chatting.",timestamp:(new Date).getTime()},t={username:"",message:"".concat(s.username," joined the chat!"),timestamp:(new Date).getTime()};s.sendMessageToMe(e),s.sendMessageToOthers(t),s.updateUserList(t.username),s.socket.on(k,s.disconnect)},this.sendMessageToOthers=function(e){"function"===typeof s.socket.emit?s.socket.emit(y,e):console.error("Cannot emit socket messages. Socket.io not connected.")},this.sendMessageToMe=function(e){"function"===typeof s.socket.emit?s.socket.emit(C,e):console.error("Cannot emit socket messages. Socket.io not connected.")},this.updateUserList=function(e){"function"===typeof s.socket.emit?s.socket.emit(T,e):console.error("Cannot emit socket messages. Socket.io not connected.")},this.disconnect=function(){console.log("DISCONNECT");var e={username:"",message:"".concat(s.username," left the chat!"),timestamp:(new Date).getTime()};s.sendMessageToOthers(e),s.socket.close()},this.onChange=t,this.onMessage=n,this.socket="",this.username="",this.port=""},j=function(e){var t=new N((function(t){e.dispatch(function(e){return{type:"CONNECTION_CHANGED",connected:e,isError:!1}}(t))}),(function(t){console.log("TULEEX"),e.dispatch(function(e){return{type:"SEND_MESSAGE_RESPONSE",message:e}}(t))}));return function(n){return function(s){var a=e.getState().socketReducer;switch(s.type){case"CONNECT_SOCKET":t.connect(s.username,Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).PORT||a.port);break;case"SEND_MESSAGE_REQUEST":t.sendMessageToOthers(s.message)}return n(s)}}},M=Object(o.combineReducers)({messageReducer:g,socketReducer:h,userReducer:E});var _=n(5),R=n(6),D=n(7),U=function(e){Object(D.a)(n,e);var t=Object(R.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n,[{key:"render",value:function(){var e=this.props.usernames;return a.a.createElement("div",null,a.a.createElement("p",{style:{fontWeight:"bold"}},"Users online:"),a.a.createElement("ul",{className:"user-list",id:"user-list"},e.map((function(e){return a.a.createElement("li",{key:e},e)}))))}}]),n}(a.a.Component),w=Object(c.b)((function(e){return{usernames:e.userReducer.usernames}}))(U),A=function(e){Object(D.a)(n,e);var t=Object(R.a)(n);function n(e){var s;return Object(v.a)(this,n),(s=t.call(this,e)).messageListRef=a.a.createRef(),s.scrollToBottom=function(e){e.scrollTop=e.scrollHeight},s.state={apiCall:""},s}return Object(_.a)(n,[{key:"componentDidUpdate",value:function(){var e=this.messageListRef.current;e.scrollTop,e.clientHeight,e.scrollHeight,b()("/")}},{key:"render",value:function(){var e=this.props.messages;return a.a.createElement("div",null,a.a.createElement("div",{className:"message-list",id:"message-list",ref:this.messageListRef,style:{display:"inline-block",height:"calc(100vh - 200px)",overflowY:"scroll",padding:"0 10px 0 10px",width:"50%"}},e.map((function(e){return e.message?a.a.createElement("div",{className:"message-item",key:e.timestamp},e.username.length>0?a.a.createElement("div",null,a.a.createElement("p",{className:"message-from",style:{fontWeight:"bold",marginBottom:0}},e.username),a.a.createElement("p",{style:{marginTop:0}},e.message)):e.message.includes("joined")?a.a.createElement("p",{className:"message-from joined-message",style:{marginTop:0,color:"green"}},e.message):e.message.includes("left")?a.a.createElement("p",{className:"message-from left-message",style:{marginTop:0,color:"red"}},e.message):null):null}))),a.a.createElement("div",{style:{display:"inline-block",paddingLeft:"20px"}},a.a.createElement(w,null)))}}]),n}(a.a.Component),G=Object(c.b)((function(e){return{messages:e.messageReducer.messages}}))(A),H=function(e){Object(D.a)(n,e);var t=Object(R.a)(n);function n(){var e;Object(v.a)(this,n);for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={username:"",message:""},e.keyPress=function(t){"Enter"===t.key&&e.sendChatMessage()},e.sendChatMessage=function(){""!==e.state.message&&(e.props.sendMessage({username:e.state.username,message:e.state.message,timestamp:(new Date).getTime()}),e.setState({message:""}))},e.sendChatMessageWithParams=function(t){e.props.sendMessage(t)},e.updateUsername=function(t){e.setState({username:t.currentTarget.value}),e.props.changeUsername(t.currentTarget.value)},e.updateMessage=function(t){e.setState({message:t.currentTarget.value})},e}return Object(_.a)(n,[{key:"componentDidMount",value:function(){var e="Guest"+Math.floor(1001*Math.random());this.setState({username:e}),this.props.connectSocket(e),this.props.userJoined(e)}},{key:"render",value:function(){var e=this.state,t=e.username,n=e.message;return a.a.createElement("div",null,a.a.createElement("div",{className:"chat-form"},a.a.createElement("input",{id:"nickname-input",value:t,onChange:this.updateUsername}),a.a.createElement("br",null),a.a.createElement("input",{id:"chat-input",value:n,onChange:this.updateMessage,onKeyPress:this.keyPress,className:"chat-input",placeholder:"Type a message...",autoFocus:!0}),a.a.createElement("button",{onClick:this.sendChatMessage,id:"send-message-btn"},"Send")))}}]),n}(a.a.Component),L=Object(c.b)(null,(function(e){return{sendMessage:function(t){return e(function(e){return{type:"SEND_MESSAGE_REQUEST",message:e}}(t))},changeUsername:function(t){return e(function(e){return{type:"CHANGE_USERNAME",username:e}}(t))},connectSocket:function(t){return e(function(e){return{type:"CONNECT_SOCKET",username:e}}(t))},userJoined:function(t){return e(function(e){return{type:"USER_JOINED",username:e}}(t))}}}))(H),P=function(){return a.a.createElement("div",{className:"chat-page"},a.a.createElement(G,null),a.a.createElement(L,null))},I=function(){return a.a.createElement("h1",null,"Not found")},W=n(53),x=n(11),J=function(e){Object(D.a)(n,e);var t=Object(R.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n,[{key:"render",value:function(){return a.a.createElement(W.a,null,a.a.createElement("div",null,a.a.createElement(x.c,null,a.a.createElement(x.a,{exact:!0,path:"/",component:P}),a.a.createElement(x.a,{component:I}))))}}]),n}(a.a.Component),K=function(e){Object(D.a)(n,e);var t=Object(R.a)(n);function n(){return Object(v.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n,[{key:"render",value:function(){return a.a.createElement(J,null)}}]),n}(a.a.Component),B=function(){var e=[i.a],t=o.applyMiddleware.apply(void 0,e.concat([j]));return Object(o.createStore)(M,Object(u.composeWithDevTools)(t))}();Object(r.render)(a.a.createElement(c.a,{store:B},a.a.createElement(K,null)),document.getElementById("root"))}},[[56,1,2]]]);
//# sourceMappingURL=main.2e0588e0.chunk.js.map