{"version":3,"sources":["store/message/actions/index.tsx","store/message/reducer/index.tsx","store/socket/actions/index.tsx","store/socket/reducer/index.tsx","store/user/actions/index.tsx","store/user/reducer/index.tsx","store/socket/middleware/Socket.tsx","store/socket/middleware/index.tsx","store/index.tsx","components/UserList.tsx","components/MessageList.tsx","components/ChatForm.tsx","components/ChatPage.tsx","components/NotFound.tsx","routes/AppRouter.tsx","App.tsx","index.tsx"],"names":["SEND_MESSAGE_RESPONSE","SEND_MESSAGE_REQUEST","initialState","username","concat","Math","floor","random","messages","messageReducer","state","arguments","length","undefined","action","type","Object","objectSpread","message","toConsumableArray","CONNECTION_CHANGED","connected","socketReducer","reduced","assign","isError","USER_JOINED","USER_LEFT","CHANGE_USERNAME","usernames","userReducer","filter","map","EVENTS","Socket","onChange","onMessage","_this","this","classCallCheck","port","socket","connect","io","on","onConnected","helloMessage","timestamp","Date","getTime","joinMessage","sendMessageToMe","sendMessageToOthers","updateUserList","disconnect","emit","console","error","log","leaveMessage","close","socketMiddleware","store","isConnected","dispatch","connectionChanged","messageReceived","next","socketState","getState","process","PORT","rootReducer","combineReducers","UserList","_React$Component","possibleConstructorReturn","getPrototypeOf","apply","inherits","createClass","key","value","props","react_default","a","createElement","style","fontWeight","className","id","React","Component","MessageList","call","messageListRef","createRef","scrollToBottom","elementToBeScrolled","scrollTop","scrollHeight","apiCall","messageListElement","current","clientHeight","socketIOClient","ref","display","height","overflowY","padding","width","marginBottom","marginTop","includes","color","paddingLeft","components_UserList","ChatForm","_getPrototypeOf2","_len","args","Array","_key","keyPress","e","sendChatMessage","sendMessage","setState","sendChatMessageWithParams","updateUsername","event","currentTarget","changeUsername","updateMessage","connectSocket","userJoined","_this$state","onKeyPress","placeholder","autoFocus","onClick","ChatPage","components_MessageList","components_ChatForm","NotFound","AppRouter","react_router_dom","react_router","exact","path","component","App","routes_AppRouter","middlewares","thunk","middlewareEnhancer","applyMiddleware","createStore","composeWithDevTools","configureStore","render","es","src_App","document","getElementById"],"mappings":"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","file":"static/js/main.4e478bdf.chunk.js","sourcesContent":["import { Message } from '../types';\r\n\r\nexport const SEND_MESSAGE_RESPONSE = 'SEND_MESSAGE_RESPONSE';\r\nexport const SEND_MESSAGE_REQUEST = 'SEND_MESSAGE_REQUEST';\r\n\r\nexport const messageReceived = (message: Message) => {\r\n  return {\r\n    type: SEND_MESSAGE_RESPONSE,\r\n    message\r\n  };\r\n};\r\n\r\nexport const sendMessage = (message: Message) => {\r\n  return {\r\n    type: SEND_MESSAGE_REQUEST,\r\n    message\r\n  };\r\n};","import {\r\n  SEND_MESSAGE_RESPONSE,\r\n  SEND_MESSAGE_REQUEST\r\n} from '../actions';\r\nimport { Message } from '../types';\r\n\r\ninterface State {\r\n  username: string;\r\n  messages: Message[];\r\n}\r\n\r\nconst initialState: State = {\r\n  username: `Guest${Math.floor(Math.random() * 1001)}`,\r\n  messages: []\r\n};\r\n\r\nexport function messageReducer(\r\n  state = initialState,\r\n  action: { type: string, message: Message }) {\r\n    switch (action.type) {\r\n      case SEND_MESSAGE_REQUEST:\r\n          return {\r\n            ...state,\r\n            messages: state.messages.concat(action.message)\r\n          };\r\n      case SEND_MESSAGE_RESPONSE:\r\n        return {\r\n          ...state,\r\n          messages: [...state.messages, action.message]\r\n        };\r\n      default:\r\n        return state;\r\n    };\r\n};\r\n\r\nexport default messageReducer;","export const CONNECTION_CHANGED = 'CONNECTION_CHANGED';\r\nexport const CONNECT_SOCKET = 'CONNECT_SOCKET';\r\n\r\nexport const connectionChanged = (isConnected: boolean) => {\r\n  return {\r\n    type: CONNECTION_CHANGED,\r\n    connected: isConnected,\r\n    isError: false\r\n  };\r\n};\r\n\r\nexport const connectSocket = (username: string) => {\r\n  return {\r\n    type: CONNECT_SOCKET,\r\n    username\r\n  };\r\n};","import { CONNECTION_CHANGED } from '../actions';\r\n\r\nconst initialState = {\r\n  connected: false\r\n};\r\n\r\nfunction socketReducer(state = initialState, action: { type: string, connected: boolean }) {\r\n  let reduced;\r\n  switch (action.type) {\r\n    case CONNECTION_CHANGED:\r\n      reduced = Object.assign({}, state, {\r\n        connected: action.connected,\r\n        isError: false\r\n      });\r\n      break;\r\n    default:\r\n      reduced = state;\r\n  }\r\n  return reduced;\r\n}\r\n\r\nexport default socketReducer;","export const USER_JOINED = 'USER_JOINED';\r\nexport const USER_LEFT = 'USER_LEFT';\r\nexport const CHANGE_USERNAME = 'CHANGE_USERNAME';\r\n\r\nexport const userJoined = (username: string) => {\r\n  return {\r\n    type: USER_JOINED,\r\n    username\r\n  };\r\n};\r\n\r\nexport const userLeft = (username: string) => {\r\n  return {\r\n    type: USER_LEFT,\r\n    username\r\n  };\r\n};\r\n\r\nexport const changeUsername = (username: string) => {\r\n  return {\r\n    type: CHANGE_USERNAME,\r\n    username\r\n  };\r\n};","import {\r\n  USER_JOINED,\r\n  USER_LEFT,\r\n  CHANGE_USERNAME\r\n} from '../actions';\r\n\r\ninterface State {\r\n  usernames: string[];\r\n}\r\n\r\nconst initialState: State = {\r\n  usernames: []\r\n};\r\n\r\nexport function userReducer(\r\n  state = initialState,\r\n  action: { type: string, username: string }) {\r\n    switch (action.type) {\r\n      case USER_JOINED:\r\n        return {\r\n          usernames: state.usernames.concat(action.username)\r\n        };\r\n      case USER_LEFT:\r\n        return {\r\n          usernames: state.usernames.filter(username => username !== action.username)\r\n        };\r\n      case CHANGE_USERNAME:\r\n        return {\r\n          usernames: state.usernames.map(username => (username === action.username ? action.username : username))\r\n        };\r\n      default:\r\n        return state;\r\n    };\r\n};\r\n\r\nexport default userReducer;","import * as io from 'socket.io-client';\r\nimport { Message } from '../../message/types';\r\n\r\nconst EVENTS = {\r\n  CONNECT: 'connect',\r\n  DISCONNECT: 'disconnect',\r\n  MESSAGE: 'message',\r\n  CHATBOT: 'chatbot',\r\n  UPDATE_USER_LIST: 'update_user_list'\r\n};\r\n\r\nexport default class Socket {\r\n  public username: string;\r\n  public port: string;\r\n  private onChange: (isConnected: boolean) => void;\r\n  private onMessage: (message: Message) => void;\r\n  private socket: any;\r\n\r\n  constructor(onChange: (isConnected: boolean) => void, onMessage: (message: Message) => void) {\r\n    this.onChange = onChange;\r\n    this.onMessage = onMessage;\r\n    this.socket = '';\r\n    this.username = '';\r\n    this.port = '';\r\n  };\r\n\r\n  public connect = (username: string, port: string) => {\r\n    this.username = username;\r\n    this.port = port;\r\n\r\n    // const host = `localhost:${port}`; // Running from local network\r\n    // this.socket = io.connect(host);\r\n    this.socket = io.connect(); // Running from Heroku\r\n\r\n    this.socket.on(EVENTS.CONNECT, this.onConnected);\r\n  };\r\n\r\n  public onConnected = () => {\r\n    this.socket.on(EVENTS.MESSAGE, this.onMessage);\r\n    this.onChange(true);\r\n\r\n    const helloMessage: Message = {\r\n      username: 'Chat Bot',\r\n      message: 'Hello ' + this.username + '! Change the nickname and start chatting.',\r\n      timestamp: new Date().getTime()\r\n    };\r\n\r\n    const joinMessage: Message = {\r\n      username: '',\r\n      message: `${this.username} joined the chat!`,\r\n      timestamp: new Date().getTime()\r\n    }\r\n\r\n    this.sendMessageToMe(helloMessage);\r\n    this.sendMessageToOthers(joinMessage);\r\n    this.updateUserList(joinMessage.username);\r\n    this.socket.on(EVENTS.DISCONNECT, this.disconnect);\r\n  };\r\n\r\n  public sendMessageToOthers = (message: Message) => {\r\n    if (typeof this.socket.emit === 'function') {\r\n      this.socket.emit(EVENTS.MESSAGE, message)\r\n    } else {\r\n      console.error('Cannot emit socket messages. Socket.io not connected.');\r\n    }\r\n  }\r\n\r\n  public sendMessageToMe = (message: Message) => {\r\n    if (typeof this.socket.emit === 'function') {\r\n      this.socket.emit(EVENTS.CHATBOT, message)\r\n    } else {\r\n      console.error('Cannot emit socket messages. Socket.io not connected.');\r\n    }\r\n  }\r\n\r\n  public updateUserList = (username: string) => {\r\n    if (typeof this.socket.emit === 'function') {\r\n      this.socket.emit(EVENTS.UPDATE_USER_LIST, username)\r\n    } else {\r\n      console.error('Cannot emit socket messages. Socket.io not connected.');\r\n    }\r\n  }\r\n\r\n  public disconnect = () => {\r\n    console.log(\"DISCONNECT\");\r\n    const leaveMessage: Message = {\r\n      username: '',\r\n      message: `${this.username} left the chat!`,\r\n      timestamp: new Date().getTime()\r\n    }\r\n    this.sendMessageToOthers(leaveMessage);\r\n    this.socket.close();\r\n  }\r\n}","import Socket from './Socket';\r\nimport { CONNECT_SOCKET, connectionChanged } from '../actions';\r\nimport { messageReceived, SEND_MESSAGE_REQUEST } from '../../message/actions';\r\nimport { Message } from '../../message/types';\r\n\r\nconst socketMiddleware = (store: any) => {\r\n\r\n  const onConnectionChange = (isConnected: boolean) => {\r\n    store.dispatch(connectionChanged(isConnected));\r\n  };\r\n\r\n  const onIncomingMessage = (message: Message) => {\r\n    console.log(\"TULEEX\");\r\n    store.dispatch(messageReceived(message));\r\n  };\r\n\r\n  const socket = new Socket(onConnectionChange, onIncomingMessage);\r\n\r\n  return (next: any) => (action: any) => {\r\n    const socketState = store.getState().socketReducer;\r\n\r\n    switch (action.type) {\r\n      case CONNECT_SOCKET:\r\n        socket.connect(action.username, process.env.PORT || socketState.port);\r\n        break;\r\n      \r\n      case SEND_MESSAGE_REQUEST:\r\n        socket.sendMessageToOthers(action.message);\r\n        break;\r\n\r\n      default:\r\n        break;\r\n    };\r\n    return next(action);\r\n  };\r\n};\r\n\r\nexport default socketMiddleware;","import { createStore, combineReducers, applyMiddleware } from 'redux';\r\nimport thunk from 'redux-thunk';\r\nimport { composeWithDevTools } from 'redux-devtools-extension';\r\nimport messageReducer from './message/reducer';\r\nimport socketReducer from './socket/reducer';\r\nimport userReducer from './user/reducer';\r\nimport socketMiddleware from './socket/middleware';\r\n\r\nconst rootReducer = combineReducers({\r\n  messageReducer: messageReducer,\r\n  socketReducer: socketReducer,\r\n  userReducer: userReducer\r\n});\r\n\r\nexport type AppState = ReturnType<typeof rootReducer>;\r\n\r\nexport default function configureStore() {\r\n  const middlewares = [thunk];\r\n  const middlewareEnhancer = applyMiddleware(...middlewares, socketMiddleware);\r\n\r\n  const store = createStore(\r\n    rootReducer,\r\n    composeWithDevTools(middlewareEnhancer)\r\n  );\r\n\r\n  return store;\r\n};","import React from 'react';\r\nimport { connect } from 'react-redux';\r\n\r\ninterface UserListState {\r\n  userReducer: {\r\n    usernames: string[];\r\n  }\r\n}\r\n\r\ninterface UserListProps {\r\n  usernames: string[];\r\n}\r\n\r\nexport class UserList extends React.Component<UserListProps> {\r\n  render() {\r\n    const { usernames } = this.props as UserListProps;\r\n    return (\r\n      <div>\r\n        <p style={{fontWeight: 'bold'}}>Users online:</p>\r\n        <ul className=\"user-list\" id=\"user-list\">\r\n          {usernames.map(username => (\r\n            <li key={username}>{username}</li>\r\n          ))}\r\n        </ul>\r\n      </div>\r\n    );\r\n  };\r\n}\r\n\r\nconst mapStateToProps = (state: UserListState) => ({\r\n  usernames: state.userReducer.usernames\r\n});\r\n\r\nexport default connect(mapStateToProps)(UserList);","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { Message } from '../store/message/types';\r\nimport UserList from './UserList';\r\nimport socketIOClient from \"socket.io-client\";\r\n\r\ninterface MessageListState {\r\n  messageReducer: {\r\n    messages: Message[];\r\n  }\r\n}\r\n\r\ninterface MessageListProps {\r\n  messages: Message[];\r\n}\r\n\r\nexport class MessageList extends React.Component<MessageListProps, { apiCall: string }> {\r\n  constructor(props: any) {\r\n    super(props);\r\n    this.state = {\r\n      apiCall: ''\r\n    }\r\n  }\r\n  \r\n  messageListRef = React.createRef<HTMLDivElement>();\r\n\r\n  componentDidUpdate(): void {\r\n    const messageListElement: Element = this.messageListRef.current as Element;\r\n    const shouldScroll: boolean = messageListElement.scrollTop + messageListElement.clientHeight !== messageListElement.scrollHeight;\r\n\r\n    const socket = socketIOClient('/');\r\n    // socket.on('apiCall', (data: string) => this.setState({ apiCall: data }));\r\n    // if (shouldScroll) {\r\n    //   this.scrollToBottom(messageListElement);\r\n    // }\r\n  }\r\n\r\n  scrollToBottom = (elementToBeScrolled: Element): void => {\r\n    elementToBeScrolled.scrollTop = elementToBeScrolled.scrollHeight;\r\n  };\r\n\r\n  render() {\r\n    const { messages } = this.props as MessageListProps;\r\n\r\n    return (\r\n      <div>\r\n        <div className=\"message-list\" id=\"message-list\" ref={this.messageListRef} style={{ display: 'inline-block', height: 'calc(100vh - 200px)', overflowY: 'scroll', padding: '0 10px 0 10px', width: '50%' }}>\r\n          {messages.map((message: Message) => (\r\n            message.message ?\r\n              <div className=\"message-item\" key={message.timestamp}>\r\n                {message.username.length > 0\r\n                ?\r\n                  <div>\r\n                    <p className=\"message-from\" style={{ fontWeight: 'bold', marginBottom: 0 }}>{message.username}</p>\r\n                    <p style={{ marginTop: 0 }}>{message.message}</p>\r\n                  </div>\r\n                :\r\n                  message.message.includes(\"joined\")\r\n                  ?\r\n                    <p className=\"message-from joined-message\" style={{ marginTop: 0, color: 'green' }}>{message.message}</p>\r\n                  :\r\n                    message.message.includes(\"left\")\r\n                    ?\r\n                      <p className=\"message-from left-message\" style={{ marginTop: 0, color: 'red' }}>{message.message}</p>\r\n                    : null}\r\n              </div>\r\n            : null\r\n          ))}\r\n        </div>\r\n        <div style={{ display: 'inline-block', paddingLeft: '20px' }}>\r\n          <UserList />\r\n        </div>\r\n      </div>\r\n    );\r\n  };\r\n}\r\n\r\nconst mapStateToProps = (state: MessageListState) => ({\r\n  messages: state.messageReducer.messages\r\n});\r\n\r\nexport default connect(mapStateToProps)(MessageList);","import React from 'react';\r\nimport { connect } from 'react-redux';\r\nimport { sendMessage } from '../store/message/actions';\r\nimport { changeUsername } from '../store/user/actions';\r\nimport { Message } from '../store/message/types';\r\nimport { connectSocket } from '../store/socket/actions';\r\nimport { userJoined } from '../store/user/actions';\r\n\r\ninterface ChatFormProps {\r\n  sendMessage: (message: Message) => void;\r\n  changeUsername: (username: string) => void;\r\n  connectSocket: (username: string) => void;\r\n  userJoined: (username: string) => void;\r\n}\r\n\r\ntype UpdateMessageParam = React.SyntheticEvent<{ value: string }>;\r\ntype UpdateUsernameParam = React.SyntheticEvent<{ value: string }>;\r\n\r\nexport class ChatForm extends React.Component<ChatFormProps> {\r\n  state = {\r\n    username: '',\r\n    message: ''\r\n  };\r\n\r\n  componentDidMount() {\r\n    const username = \"Guest\" + Math.floor(Math.random() * 1001);\r\n    this.setState({ username });\r\n\r\n    this.props.connectSocket(username);\r\n    this.props.userJoined(username);\r\n  }\r\n\r\n  keyPress = (e: React.KeyboardEvent<any>) => {\r\n    if (e.key === \"Enter\") {\r\n      this.sendChatMessage();\r\n    }\r\n  }\r\n\r\n  sendChatMessage = (): void => {\r\n    if (this.state.message !== '') {\r\n      this.props.sendMessage({\r\n        username: this.state.username,\r\n        message: this.state.message,\r\n        timestamp: new Date().getTime()\r\n      });\r\n      this.setState({ message: '' });\r\n    }\r\n  };\r\n\r\n  sendChatMessageWithParams = (message: Message) => {\r\n    this.props.sendMessage(message);\r\n  }\r\n\r\n  updateUsername = (event: UpdateUsernameParam) => {\r\n    this.setState({ username: event.currentTarget.value });\r\n    this.props.changeUsername(event.currentTarget.value);\r\n  }\r\n\r\n  updateMessage = (event: UpdateMessageParam) => {\r\n    this.setState({ message: event.currentTarget.value });\r\n  };\r\n\r\n  render() {\r\n    const { username, message } = this.state;\r\n\r\n    return (\r\n      <div>\r\n        <div className=\"chat-form\">\r\n          <input\r\n            id=\"nickname-input\"\r\n            value={username}\r\n            onChange={this.updateUsername}\r\n          />\r\n          <br />\r\n          <input\r\n            id=\"chat-input\"\r\n            value={message}\r\n            onChange={this.updateMessage}\r\n            onKeyPress={this.keyPress}\r\n            className=\"chat-input\"\r\n            placeholder=\"Type a message...\"\r\n            autoFocus\r\n          />\r\n          <button onClick={this.sendChatMessage} id=\"send-message-btn\">Send</button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapDispatchToProps = (dispatch: any): ChatFormProps => ({\r\n  sendMessage: (message: Message) => dispatch(sendMessage(message)),\r\n  changeUsername: (username: string) => dispatch(changeUsername(username)),\r\n  connectSocket: (username: string) => dispatch(connectSocket(username)),\r\n  userJoined: (username: string) => dispatch(userJoined(username))\r\n});\r\n\r\nexport default connect(null, mapDispatchToProps)(ChatForm);","import React from 'react';\r\nimport MessageList from './MessageList';\r\nimport ChatForm from './ChatForm';\r\n\r\nconst ChatPage = () => {\r\n  return (\r\n    <div className=\"chat-page\">\r\n      <MessageList />\r\n      <ChatForm />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default ChatPage;","import React from 'react';\r\n\r\nconst NotFound: React.FC = () => <h1>Not found</h1>\r\n\r\nexport default NotFound","import React from 'react';\r\nimport ChatPage from '../components/ChatPage';\r\nimport NotFound from '../components/NotFound';\r\nimport { Route, BrowserRouter as Router, Switch } from 'react-router-dom';\r\n\r\nclass AppRouter extends React.Component {\r\n  render() {\r\n    return (\r\n      <Router>\r\n        <div>\r\n          <Switch>\r\n            <Route exact path=\"/\" component={ChatPage} />\r\n            <Route component={NotFound} />\r\n          </Switch>\r\n        </div>\r\n      </Router>\r\n    );\r\n  };\r\n}\r\n\r\nexport default AppRouter;","import React from 'react';\nimport AppRouter from './routes/AppRouter';\n\nclass App extends React.Component {\n  public render() {\n    return (\n      <AppRouter />\n    );\n  };\n}\n\nexport default App;","import React from 'react';\nimport { render } from 'react-dom';\nimport { Provider } from 'react-redux';\nimport configureStore from './store';\nimport App from './App';\n\nconst store = configureStore();\n\nrender(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n);"],"sourceRoot":""}